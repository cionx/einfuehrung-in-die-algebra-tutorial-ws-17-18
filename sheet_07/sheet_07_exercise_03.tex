\section{}

Für alle $n \geq 1$ schreiben im Folgenden
\[
            \mu_n
  \coloneqq \{
              \zeta \in W_n
            \suchthat
              \text{$\zeta$ ist eine primitive $n$-te Einheitswurzel}
            \}\,.
\]





\subsection{}

Für jedes $n \geq 1$ gilt
\begin{align*}
    W_n
  &=  \{
        e^{2 \pi i  k / n}
      \suchthat
        k = 0, \dotsc, n-1
      \}
  &=  \{
        \cos(2 \pi k / n) + i \sin(2 \pi k /n )
      \suchthat
        k = 0, \dotsc, n-1
      \}
\end{align*}
Aus $\cos(2 \pi /3) = \cos(4 \pi / 3)  = -1/2$ und $\sin(2 \pi / 3) = \sqrt{3}/2$, $\sin(4 \pi /3) = -\sqrt{3}/2$ folgen damit, dass
\begin{align*}
  W_2 &= \{ 1, -1 \}\,, \\
  W_3 &= \left\{ 1, -\frac{1}{2} + i \frac{\sqrt{3}}{2}, -\frac{1}{2} - i \frac{\sqrt{3}}{2} \right\}\,, \\
  W_4 &= \{ 1, i, -1, -i \}\,.
\end{align*}





\subsection{}

Für alle $n \geq 1$ ist die Abbildung
\[
          \varphi_n
  \colon  \Integer
  \to     \Complex^\times\,,
  \quad   k
  \mapsto e^{2 \pi i k / n}
\]
ist ein Gruppenhomomorphismus mit $\im \varphi_n = W_n$ und $\ker \varphi = n \Integer$.
Somit ist $W_n$ eine Untergruppe von $\Complex^\times$, und $\varphi_n$ induziert nach der universellen Eigenschaft des Quotienten einen Gruppenisomorphismus
\[
          \Integer/n
  \to     W_n,
  \quad   \class{k}
  \mapsto \varphi_n(k)
  =       e^{2 \pi i k / n}.
\]

Die Abbildung
\[
          \varphi_\infty
  \colon  \Rational
  \to     \Complex^\times\,,
  \quad   \frac{p}{q}
  \mapsto e^{2 \pi i p /q}\,,
\]
ist ein Gruppenhomomorphismus mit $\im \varphi_\infty = \bigcup_{n \geq 1} W_n \eqqcolon W_\infty$ und $\ker \Integer$.
Somit ist $W_\infty$ eine Untergruppe von $\Complex^\times$, und $\varphi_\infty$ induziert nach der universellen Eigenschaft des Quotienten einen Gruppenisomorphismus
\[
          \Rational/\Integer
  \to     W_\infty\,,
  \quad   \class{ \frac{p}{q} }
  \mapsto \varphi_\infty\left( \frac{p}{q} \right)
  =       e^{2 \pi i p /q}\,.
\]

\begin{remark}
  Wir werden sehen, dass für einen beliebigen Körper $K$ die Gruppe der Einheitswurzeln
  \[
              W_n(K)
    \coloneqq \{x \in K \suchthat x^n = 1\}
  \]
  zyklisch ist;
  dies wird daraus folgen, dass jede endliche Untergruppe $H \subgroup K^\times$ zylisch ist.
  Gilt $\ringchar{K} = 0$, so hat die Gruppe $W_n(K)$ Ordnung $n$;
  gilt hingegen $\ringchar{K} = p > 0$, und ist $n = p^r m$ mit $p \ndivides m$, so hat die Gruppe $W_n(K)$ Ordnung $m$.
\end{remark}





\subsection{}

Entscheidend ist die folgende Beobachtung:

\begin{lemma}
  \label{lemma: decomposition into cyclotomic polynomials}
  Für alle $n \geq 1$ gilt
  \[
      t^n - 1
    = \prod_{d \divides n} \Phi_d(t)\,.
  \]
\end{lemma}

\begin{proof}
  Für $\zeta \in W_n$ sei $d \coloneqq \ord{\zeta}$.
  Es gilt $\zeta^d = 1$, weshalb $\zeta$ eine $d$-te Einheitswurzel ist, d.h.\ es gilt $\zeta \in W_d$.
  Da
  \[
      \ord{\zeta}
    = d
    = \ord{W_d}
  \]
  gilt, ist $\zeta$ bereits ein zyklischer Erzeuger von $W_d$.
  Also ist $\zeta$ eine primitive $d$-te Einheitswurzel.
  Zudem gilt
  \[
              d
    =         \ord{\zeta}
    \divides  \ord{W_n}
    =         n\,.
  \]
  Damit erhalten wir ingesamt, dass
  \[
      W_n
    = \coprod_{d \divides n} \{ \zeta \in W_n \suchthat \ord{\zeta} = d \}
    = \coprod_{d \divides n} \mu_n\,.
  \]
  (Hier steht $\coprod$ für die disjunkte Vereinigung.)
  \[
      t^n - 1
    = \prod_{\zeta \in W_n} (t - \zeta)
    = \prod_{d \divides n} \prod_{\zeta \in \mu_d} (t - \zeta)
    = \prod_{d \divides n} \Phi_d(t)\,.
  \]
  Das zeigt die Gleichheit.
\end{proof}

\begin{remark}
  Die obige Argumentation lässt sich dahingehend verallgemeinern, dass für jede Gruppe $G$ die disjunkte Zerlegung
  \begin{align*}
        G
    &=  \coprod_{H \subgroup G} \{\text{$h \in H$ ist ein zyklischer Erzeuger von $H$}\}  \\
    &=  \coprod_{\substack{H \subgroup G \\ \text{zyklisch}}} \{\text{$h \in H$ ist ein Erzeuger von $H$}\}
  \end{align*}
  gilt.
  Dies ist nur eine Umformulierung der Tatsache, dass jedes Element $g \in G$ eine eindeutige (zyklische) Untergruppe $\generated{g} \subgroup G$ erzeugt.
\end{remark}

\begin{remark}
  Aus Lemma~\ref{lemma: decomposition into cyclotomic polynomials} folgt insbesondere, dass für jede natürliche Zahl $n \geq 1$ die Gleichheit
  \[
      n
    = \deg(t^n - 1)
    = \sum_{d \divides n} \deg \Phi_d(t)
    = \sum_{d \divides n} \varphi(t),
  \]
  gilt, wobei $\varphi$ die Eulersche Phi-Funktion bezeichnet.
\end{remark}

Aus der Vorlesung ist bereits bekannt, dass
\[
    \Phi_p(t)
  = t^{p-1} + t^{p-2} + \dotsb + t + 1
  = \frac{t^p - 1}{t-1}
\]
für jede Primzahl $p$.
Aus Lemma~\ref{lemma: decomposition into cyclotomic polynomials} ergibt sich eine Verallgemeinerung dieser Gleichheit:

\begin{corollary}
  \label{corollary: inductive calculation of cyclotomic polynomials}
  Für alle $n \geq 1$ gilt
  \[
      \Phi_n(t)
    = \frac{t^n - 1}{\prod_{d \divides n, d \neq n} \Phi_d(t)}\,.
  \]
\end{corollary}

Mithilfe von Korollar~\ref{corollary: inductive calculation of cyclotomic polynomials} und Polynomdivision lassen sich die Kreisteilungspolynome $\Phi_n(t)$ nun induktiv berechnen.
Für $n = 1, \dotsc, 8$ erhalten wir die folgenden Ergebnisse:
\begin{align*}
      \Phi_1(t)
  &=  t-1\,,
  \\
      \Phi_2(t)
  &=  t+1\,,
  \\
      \Phi_3(t)
  &=  t^2 + t + 1\,,
  \\
      \Phi_4(t)
  &=  \frac{t^4 - 1}{\Phi_1(t) \Phi_2(t)}
   =  \frac{t^4 - 1}{(t-1)(t+1)}
   =  \frac{t^4 - 1}{t^2 - 1}
   =  t^2 + 1\,,
  \\
      \Phi_5(t)
  &=  t^4 + t^3 + t^2 + t + 1\,,
  \\
      \Phi_6(t)
  &=  \frac{t^6 - 1}{\Phi_1(t) \Phi_2(t) \Phi_3(t)}
   =  \frac{t^6 - 1}{(t-1)(t+1)(t^2 + t + 1)}
   =  \frac{t^6 - 1}{t^4 + t^3 - t - 1}
   =  t^2 - t + 1\,,
  \\
      \Phi_7(t)
  &=  t^6 + t^5 + t^4 + t^3 + t^2 + t + 1\,,
  \\
      \Phi_8(t)
  &=  \frac{t^8 - 1}{\Phi_1(t) \Phi_2(t) \Phi_4(t)}
   =  \frac{t^8 - 1}{(t-1)(t+1)(t^2 + 1)}
   =  \frac{t^8 - 1}{t^4 - 1}
   =  t^4 +1\,.
\end{align*}

\begin{remark}
  Es fällt auf, dass alle bisher bekannten Kreisteilungspolynome (also $\Phi_p(t)$ mit $p$ prim, und $\Phi_n(t)$ für $n = 1, \dotsc, 8$) jeweils nur $1, 0, -1$ als Koeffizienten haben.
  Dieses Muster setzt sich bis $\Phi_{104}(t)$ vor; das Kreisteilungspolynome $\Phi_{105}(t)$ hat schließlich den Koeffizienten $-2$.
\end{remark}





\subsection{}

Wir geben zwei mögliche Beweise.



\subsubsection*{Durch primitive Einheitswurzeln}

Entscheidend ist die Beobachtung, dass für alle $\zeta \in \Complex$ die Äquivalenz
\[
        \zeta \in W_{np}
  \iff  \zeta^p \in W_n
\]
gilt.
Die Bedingung $p \divides n$ sorgt dafür, dass sich dies auf die primitiven Einheitswurzeln einschränkt:

\begin{claim}
  Eine Einheitswurzel $\zeta \in W_{np}$ ist genau dann primitiv, wenn $\zeta^p \in W_n$ primitiv ist.
\end{claim}

\begin{proof}
  Wir geben zwei mögliche Beweise:
  \begin{itemize}
    \item
      Ist $\zeta \in W_{np}$ primitiv, so gilt $\ord{\zeta} = np$, und somit
      \[
          \ord{\zeta^p}
        = \frac{ \kgV(\ord{\zeta}, p) }{p}
        = \frac{ \kgV(np, p) }{p}
        = \frac{ np }{ p }
        = n\,.
      \]
      Also ist auch $\zeta^p \in W_n$ primitiv.
      
      Ist andererseits $\zeta \in W_{np}$ nicht primitiv, so gilt $\ord{\zeta} < np$.
      Also ist $\ord{\zeta}$ dann ein echter Teiler von $np$.
      Es gibt daher einen echten Teiler $d$ von $np$ mit $\ord{\zeta} \divides d$, so dass $np/d$ prim ist
      (während $\ord{\zeta}$ einige Primfaktoren von $np$ fehlen, fehlt $d$ nur noch ein Primfaktor).
      Es gilt $p \divides n$, weshalb der Primfaktor $p$ in $np$ mindestens zweimal vorkommt;
      somit muss er in $d$ mindestens einmal vorkommen, weshalb $p \divides d$ gilt.
      Aus $\ord{\zeta} \divides d$ folgt $\zeta^d = 1$, und aus $p \divides d$ folgt damit, dass $(\zeta^p)^{d/p} = 1$ gilt.
      Deshalb gilt $\ord{\zeta} = d/p < np/p = n$.
      Also ist $\zeta^p$ keine primitive $n$-te Einheitswurzel.
      
    \item
      Mit den Isomorphismen
      \begin{gather*}
                \varphi
        \colon  \Integer/(np)
        \to     W_{np}\,,
        \quad   \class{k}
        \mapsto e^{2 \pi i k / (np)}
      \shortintertext{und}
                \psi
        \colon  \Integer/n
        \to     W_{n}\,,
        \quad   \class{k}
        \mapsto e^{2 \pi i k / n}
      \end{gather*}
      erhalten wir für die Gruppenhomomorphismen
      \begin{gather*}
                f
        \colon  W_{np}
        \to     W_n\,,
        \quad   \zeta
        \mapsto \zeta^p
      \shortintertext{und}
                g
        \colon  \Integer/(np)
        \to     \Integer/n\,,
        \quad   \class{k}
        \mapsto \class{k}
      \end{gather*}
      das folgende kommutative Diagramm:
      \[
        \begin{tikzcd}
            W_{np}
            \arrow{r}{f}
          & W_n
          \\
            \Integer/(np)
            \arrow{r}{g}
            \arrow{u}{\varphi}
          & \Integer/n
            \arrow[swap]{u}{\psi}
        \end{tikzcd}
      \]
      Somit erhalten wir, dass
      \begin{align*}
            &\, (\text{$\zeta \in W_{np}$ ist primitiv} \iff \text{$\zeta^p \in W_n$ ist primitiv} )  \\
        \iff&\, (\text{$\zeta \in W_{np}$ ist zyklischer Erzeuger} \iff \text{$\zeta^p \in W_n$ 
        ist zyklischer Erzeuger}) \\
        \iff&\, (\text{$\class{k} \in \Integer/(np)$ ist zyklischer Erzeuger} \iff \text{$\class{k} \in \Integer/n$ ist zkylischer Erzeuger}) \\
        \iff&\, (\text{$k$ und $np$ sind teilerfremd} \iff \text{$k$ und $n$ sind teilerfremd})\,.
      \end{align*}
      Da $p \divides n$ gilt, haben $n$ und $np$ die gleichen Primfaktoren, weshalb $k$ und $np$ genau dann teilerfremd sind, wenn $k$ und $n$ es sind.
    \qedhere
  \end{itemize}
\end{proof}

Für den Gruppenhomomorphismus
\[
          f
  \colon  W_{np}
  \to     W_n\,,
  \quad   \zeta
  \mapsto \zeta^p
\]
gilt $\ker f = W_{np} \cap W_p = W_p$ mit $|W_p| = p$, weshalb für jedes $\xi \in W_n$ die Faser $\preim{f}{\xi}$ aus $p$ Elementen besteht.
Aus der obigen Behauptung folgt, dass sich $f$ zu einer Abbildung
\[
          \tilde{f}
  \colon  \mu_{np}
  \to     \mu_n\,,
  \quad   \zeta
  \mapsto f(\zeta)
  =       \zeta^p
\]
einschränkt, wobei für jedes $\xi \in W_n$ die Gleichheit $\preim{\tilde{f}}{\xi} = \preim{f}{\xi}$ gilt, und die Faser $\preim{f}{p}$ somit aus $p$ Elementen besteht.
Wir erhalten somit eine disjunkte Zerlegung
\[
    \mu_{np}
    = \coprod_{\xi \in \mu_n} \preim{\tilde{f}}{\xi}
    = \coprod_{\xi \in \mu_n} \{ \zeta \in \mu_n \suchthat \zeta^p = \xi \}
\]
in $p$-elementige Teilmengen.
Somit gilt, dass
\begin{equation}
  \label{equation: first decomposition}
    \Phi_{np}(t)
  = \prod_{\zeta \in \mu_{np}} (t - \zeta)
  = \prod_{\xi \in \mu_n} \prod_{\substack{\zeta \in \mu_{np} \\ \zeta^p = \xi}} (t - \zeta)\,.
\end{equation}
Dabei besteht $\preim{\tilde{f}}{\xi} = \{ \zeta \in \mu_{np} \suchthat \zeta^p = \xi \}$ aus Nullstellen des Polynoms $t^p - \xi$;
da es sich zum $p$ Nullstellen handelt, gilt bereits
\[
    t^p - \xi
  = \prod_{\substack{\zeta \in \mu_{np} \\ \zeta^p = \xi}} (t - \zeta)\,.
\]
Damit erhalten wir aus \eqref{equation: first decomposition}, dass
\[
    \Phi_{np}(t)
  = \prod_{\xi \in \mu_n} (t^p - \xi)
  = \Phi_n(t^p)\,.
\]



\subsubsection*{Mithilfe der Eulerschen Phi-Funktion}

Über $\Complex$ zerfallen die Polynome $\Phi_{np}(t)$ und $\Phi_n(t^p)$ in Linearfaktoren;
es genügt daher zu zeigen, dass beide Polynome die gleichen Linearfaktoren mit jeweils gleicher Vielfachheit haben.

Es gilt $\Phi_{np}(t^p) = \prod_{\zeta \in \mu_{np}} (t - \zeta)$.
Für jede primitive $(np)$-te Einheitswurzel $\zeta \in \mu_{np}$ ist $\zeta^p$ eine primitive $n$-te Einheitswurzel, also $\zeta^p \in \mu_n$.
Somit ist $\zeta$ dann eine Nullstelle von $\Phi_n(t) = \prod_{\xi \in \mu_n} (t^p - \xi)$.
Das zeigt, dass jeder Linearfaktor von $\Phi_{np}(t)$ auch in $\Phi_n(t^p)$ auftritt.

Da jeder Linearfaktor in $\Phi_{np}(t)$ Vielfachheit $1$ hat, genügt es nun zu zeigen, dass $\deg \Phi_{np}(t) = \deg \Phi_n(t^p)$ gilt.
Ist $n = p_1^{\nu_1} p_2^{\nu_2} \dotsm p_r^{\nu_r}$ die Primfaktorzerlegung von $n$ mit $p_1 = p$ (und $p_i \neq p_j$ für $i \neq j$, sowie $\nu_i \geq 0$ für alle $i$), so ist $np = p_1^{\nu_1 + 1} p_2^{\nu_2} \dotsm p_r^{\nu_r}$ die Primfaktorzerlegung von $np$.
Es gilt deshalb
\begin{align*}
      \deg \Phi_{np}(t)
  &=  \varphi(np)
  \\
  &=  \varphi( p_1^{\nu_1 + 1} p_2^{\nu_2} \dotsm p_r^{\nu_r} )
  \\
  &=  \varphi( p_1^{\nu_1 + 1} ) \varphi( p_2^{\nu_2} ) \dotsm \varphi( p_r^{\nu_r} )
  \\
  &=  (p_1^{\nu_1 + 1} - p_1^{\nu_1}) \cdot ( p_2^{\nu_2} - p_2^{\nu_2 - 1} ) \dotsm ( p_r^{\nu_r} - p_r^{\nu_r - 1})
  \\
  &= p_1 (p_1^{\nu_1} - p_1^{\nu_1 - 1}) \cdot ( p_2^{\nu_2} - p_2^{\nu_2 - 1} ) \dotsm ( p_r^{\nu_r} - p_r^{\nu_r - 1})
  \\
  &= \dotsb
  \\
  &= p_1 \varphi(n)
   = p \, \varphi(n)
   = p \deg \Phi_n(t)
   = \deg \Phi_n(t^p)\,.
\end{align*}



\subsubsection*{Explizite Formel für $\Phi_{p^k}(t)$}

Damit ergibt sich nun für alle $k \geq 1$, dass
\[
    \Phi_{p^k}(t)
  = \Phi_{p^{k-1}}(t^p)
  = \Phi_{p^{k-2}}((t^p)^p)
  = \Phi_{p^{k-2}}\left( t^{(p^2)} \right)
  = \dotsb
  = \Phi_p\left( t^{(p^{k-1})} \right)\,,
\]
und mit $\Phi_p(t) = \sum_{l=0}^{p-1} t^l$ somit
\[
    \Phi_{p^k}(t)
  = \sum_{l=0}^{p-1} \left( t^{(p^{k-1})} \right)^l
  = \sum_{l=0}^{p-1} t^{l p^{(k-1)}}\,.
\]





\subsection{}

Da $\Rational$ ein Körper ist, gibt es eindeutige Polynome $q, r \in \Rational[t]$ mit den gewünschten Bedingungen.
Das Polynom $q$ lässt sich durch Polynomdivision von $g$ durch $f$ ausrechnen.
Die Rechenoperationen, die dabei in $\Rational[t]$ verwendet werden, sind dabei
\begin{itemize}
  \item
    Ringoperationen, d.h.\ Addition, Subtraktion und Multiplikation, und
  \item
    Division durch den Leitkoeffizienten von $f$.
\end{itemize}
Da $f$ nomiert sind, verlassen wir ausgehend von $g \in \Integer[t]$ dabei den Ring $\Integer[t]$ nicht.
Somit ergibt sich, dass bereits $g \in \Integer[t]$ gilt.
Damit gilt auch $r = g - qf \in \Integer[t]$.

Das zeigt die Existenz und Eindeutig der gewünschten Polynome $q, r \in \Integer[t]$;
sie können durch die übliche Polynomdivision berechnet werden.





\subsection{}

Die Normiertheit von $\Phi_n(t)$ ergibt sich dadurch, dass es sich (per Definition) um eine Produkt von Linearfaktoren handelt.
Dass bereits $\Phi_n(t) \in \Integer[t]$ gilt, ergibt sich induktiv:
Wir wissen bereits, dass $\Phi_1(t) \in \Integer[t]$ gilt.
Für alle $n > 1$ haben wir nach Korollar~\ref{corollary: inductive calculation of cyclotomic polynomials}, dass
\[
    \Phi_n(t)
  = \frac{t^n - 1}{\prod_{d \divides n, d \neq n} \Phi_d(t)}
\]
gilt.
Die die Polynome $\Phi_d(t)$ mit $d \divides n$, $d < n$ normiert und nach Induktionsvoraussetzung ganzzahlig sind, ist auch $\prod_{d \divides n, d \neq n} \Phi_d(t)$ normiert und ganzzahlig.
Aus dem vorherigen Aufgabenteil ergibt sich damit, dass auch $\Phi_n(t)$ bereits ganzzahlig ist.

































